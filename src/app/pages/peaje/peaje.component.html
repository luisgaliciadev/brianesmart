
<div class="row animated fadeInRight">    
    <div class="col-12">     
        <div class="card">
            <!-- <h2 class="card-title">Registro de Guía</h2> -->
            <div class="card-body">

                

                <div class="row" *ngIf="loading">
                    <div class="col-sm-12">
                        <div class="alert alert-warning text-center">
                            <strong>Cargando...</strong>
                            <br>
                            <i class="fa fa-refresh fa-spin fa-2x"></i>
                            <br>
                            <span>Por Favor Espere...</span>
                        </div>
                    </div>    
                </div>

                <div class="row" *ngIf="registrando">
                    <div class="col-sm-12">
                        <div class="alert alert-primary text-center">
                            <strong>Guardando datos</strong>
                            <br>
                            <i class="fa fa-refresh fa-spin fa-2x"></i>
                            <br>
                            <span>Por Favor Espere...</span>
                        </div>
                    </div>    
                </div>

                <form *ngIf="!loading  && !registrando" ngNativeValidate #form="ngForm" class="form p-t-20">
                    <div class="row">       
                        <div class="col-sm">
                            <div class="form-group">
                                <label>Nro Orden:</label>
                                <div class="input-group">
                                    <select (change) = "datosOrden(peaje.ID_ORDEN_SERVICIO)" [(ngModel)]="peaje.ID_ORDEN_SERVICIO" name="ID_ORDEN_SERVICIO" class="form-control" required>
                                        <option value = "">Seleccione</option>
                                        <option *ngFor="let orden of ordenes" value = "{{orden.ID_ORDEN_SERVICIO}}">{{orden.CORRELATIVO}} | {{orden.DS_TIPO_SERVICIO}} | {{orden.DS_PRODUCTO}} | {{orden.DS_ORI_DEST}} | {{orden.DESTINO}}</option>
                                    </select>                                            
                                    <!-- <input [(ngModel)]="guia.ID_ORDEN_SERVICIO" name="ID_ORDEN_SERVICIO" type="text" class="form-control" placeholder="Buscar">                         -->
                                    <!-- <div class="input-group-addon"><i class="fa fa-search pointer" data-toggle="tooltip" data-placement="top" title="Buscar" (click)="getOrdenServicio(guia.ID_ORDEN_SERVICIO)"></i></div>         -->
                                </div>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div class="form-group">
                                <label>Tipo Servicio:</label>
                                <div class="input-group">                                            
                                    <input [(ngModel)]="tipoServicio" name="tipoServicio" type="text" class="form-control" disabled = "true" required>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div class="form-group">
                                <label>Producto:</label>
                                <div class="input-group">                                            
                                    <input [(ngModel)]="producto" name="producto" type="text" class="form-control" disabled = "true" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">       
                        <div class="col-sm">
                            <div class="form-group">
                                <label>Cliente:</label>
                                <div class="input-group">                                            
                                    <input [(ngModel)]="cliente" name="cliente" type="text" class="form-control" disabled = "true" required>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div class="form-group">
                                <label>Origen:</label>
                                <div class="input-group">                                            
                                    <input [(ngModel)]="origen" name="origen" type="text" class="form-control" disabled = "true" required>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div class="form-group">
                                <label>Destino:</label>
                                <div class="input-group">                                            
                                    <input [(ngModel)]="destino" name="destino" type="text" class="form-control" disabled = "true" required>
                                </div>
                            </div>
                        </div>
                    </div>

                   
                    <div class="row">       
                        <div class="col-sm">
                            <div class="form-group" >
                                <label>Conductor:</label>
                                <div class="input-group">
                                    <div class="input-group" style="width: 200px;">   
                                        <input [(ngModel)]="idConductor" name="idConductor" type="text" class="form-control" placeholder="Conductor" (focusout) = "getConductor(idConductor)" required>                        
                                        <div class="input-group-addon"><i class="fa fa-search pointer" data-toggle="tooltip" data-placement="top" title="Buscar" (click)="getConductor(idConductor)"></i></div>        
                                    </div>
                                    <div class="input-group" style="margin-left: 5px">
                                        <input [(ngModel)]="nombreConductor" name="nombreConductor" type="text" class="form-control" disabled = "true" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="width: 200px !important;">
                            <div class="form-group" >
                                <label>Monto:</label>                                
                                <div class="input-group">   
                                    <input [(ngModel)]="montoPeaje" name="montoPeaje" type="number" step="0.01" class="form-control" required>
                                </div>
                            </div>
                        </div>

                        <div style="width: 250px !important; margin-left: 15px;">
                            <div class="form-group" >
                                <label>Fecha:</label>
                                <div class="input-group">                                                                              
                                    <input [(ngModel)]="fechaPeaje" name="fechaPeaje" type="date" class="form-control" required>
                                    <div class="input-group-addon"><i class="fa fa-plus-circle pointer" data-toggle="tooltip" data-placement="top" title="Agregar" (click)="agregarConductor()"></i></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    

                    <h3>Listado de Conductores (<small>{{conductores.length}}</small>)</h3>
                    <div style="overflow: auto">
                        <table class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th style="text-align: center;">ITEM</th>
                                    <th style="text-align: center;">Nombre</th>
                                    <th style="text-align: center;">DNI</th>
                                    <th style="text-align: center;">Monto S/</th>
                                    <!-- <th style="text-align: center;">Peaje</th> -->
                                    <th style="text-align: center;">Fecha</th>
                                    <th style="text-align: center;"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let conductor of conductores; index as i ">
                                    <td align="center">{{i+1}}</td>
                                    <td align="center">{{conductor.nombre}}</td>
                                    <td align="center">{{conductor.dni}}</td>
                                    <td align="center">{{conductor.monto}}</td>
                                    <td align="center">{{conductor.fecha}}</td>                             
                                    <td align="center">                                      
                                        <a data-toggle="tooltip" data-placement="top" title="Eliminar"> <i class="fa fa-close text-danger pointer" (click)="eliminarConductor(i)"></i> </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>


                    <div class="form-group">
                        <div class="form-group">
                            <label>Observación:</label>
                            <div class="input-group">                                            
                                <textarea [(ngModel)]="peaje.OBSERVACION" name = "OBSERVACION" class="form-control" name="horaContacto" rows="2" maxlength="250"></textarea>
                            </div>
                        </div>
                    </div>

                    <button *ngIf="idPeaje == 0" type="button" class="btn btn-success waves-effect waves-light m-r-10" (click)="registerPeaje()">
                        <i class="fa fa-save"></i>
                        Guardar
                    </button>

                    <button [disabled]="!form.form.valid" *ngIf="idPeaje > 0" type="button" class="btn btn-success waves-effect waves-light m-r-10" >
                        <i class="fa fa-save"></i>
                        Moificar
                    </button>

                    <button [disabled]="!form.form.valid" *ngIf="idPeaje > 0" type="button" class="btn btn-danger waves-effect waves-light m-r-10" >
                        <i class="fa fa-trash-o"></i>
                        Anular
                    </button>

                    <button routerLink="/guias" type="button" class="btn btn-warning waves-effect waves-light m-r-10">
                        <i class="fa fa-arrow-circle-right"></i>
                        Volver
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

